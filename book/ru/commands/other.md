# Разное

## Создание файлов

Для того, чтобы продемонстрировать работу команд, нам понадобится создать несколько вспомогательных файлов. Чтобы справиться с этой задачей, ниже мы представили необходимый пример и пояснения к нему.

*Пример:*

На первой строчке мы переходим в директорию рабочего стола, на второй – создаем папку «smth», далее заходим в нее так же как в самом начале, создаем текстовый файл «myfile.txt» и редактируем его с помощью команды nano.

### 1 Команда date

Команда date позволяет оперировать датой и временем. 

**вывести дату и время.**

```
~$ date
``` 

Воспользуемся ключами. 

#### 1.1 Ключ –u 

**вывести всеобщее скоординированное время.** 

```
~$ date -u
```

#### 1.2 Ключ –d 

**узнать дату указанного дня.**

```
~$ date –d String 
```

Пояснение: вместо String надо указать день в строчном формате.

#### 1.3 Ключ –r 

**узнать дату и время последней редакции указанного файла.** 

```
~$ date –r filename
```

#### 1.4 Ключ –iso-8601

**вывести дату и время в формате ISO 8601**

```
~$ date --iso-8601=seconds
```

#### 1.5 Ключ –rfc-3339

**вывести дату и время в формате RFC 3339**

```
~$ date –rfc-3339=seconds
```
 
#### 1.6 Форматирование даты

**вывести дату в заданном формате**

```
~$ date +%Y-%m-%d_%H:%M:%S
```

Постоянными в строчке кода остаются «+» в начале, «%» перед первыми буквами слов year (год) , month (месяц), day (день), hours (часы), minutes (минуты) и seconds (секунды) соответственно. Если написать Y – то машина выведет год в формате ХХХХ, а если с малого регистра, то в формате XX. Пользователь сам может выбрать из чего ему складывать дату или время, а может, все вместе, а так же то, как будут разделяться элементы.

### 2 Команда history

**вывести весь список введенных ранее команд.** 
 
```
~$ history
```

Количество выводимых команд контролируется параметром HISTSIZE. По умолчанию он установлен на 1000, но можно изменить введя

```
~$ export HISTSIZE=10 
```

#### 2.1 Ключ n

**вывести определенное количество введенных ранее команд**

```
~$ history 5 
```

вместо цифры 5 может быть записано любое число, зависимое от того, сколько команд потребуется вывести на экран.

#### 2.2 Ключ –с

**отчистить историю.**

``` 
~$ history -c
```

#### 2.3 Ключ –d n

**удалить определенную строку в истории**

```
~$ history –d 80
```

#### 2.4  Ключ –r filename
  
**в историю вписать содержимое выбранного файла**

```
~$ history –r myfile 
``` 

Содержимое файла «myfile.txt» было рассмотрено в примере работы команды date с таким же ключом. Но мы напомним о нем с помощью команды cat.

### 3 Команда which 
 
**Сообщить пользователю, была ли найдена указанная программа в каталогах, перечисленных в переменной среды PATH.**

*Пояснение:* Когда операционная система запускает какую-нибудь программу, она стартует новый процесс и каким-то образом передаёт ему информацию о настройках среды, или окружения. Эта информация состоит из набора переменных, содержащих некоторые значения. Процесс может получить эти значения, обратившись к нужной переменной по имени. 

При помощи переменных окружения можно передавать информацию не только запускаемым процессам, но и самой операционной системе. Она тоже читает и использует значения переменных окружения, поэтому можно управлять некоторыми аспектами поведения операционной системы, изменяя переменные окружения.

Переменная PATH содержит список директорий, в которых операционная система пытается искать исполняемые файлы, если пользователь при запуске не указал явно путь к нужному исполняемому файлу.
  
```
~$ which filename
```

### 4 Команда tmux

**tmux** — это менеджер терминалов, к которому удобно подключаться и отключаться, не теряя при этом процессы и историю.

**перейти в менеджер терминалов**

``` 
~$ tmux
```  

Открытые страницы в tmux отображаются снизу.

Важная особенность tmux заключается в том, что если запустить его на сервере, то он будет помнить историю запусков процессов и они продолжат выполнение даже если соединение с сервером будет потеряно. Кроме того, при новом соединении с сервером можно будет подключиться к уже запущенному tmux и продолжить работу с момента потери связи.

Настройки для tmux хранятся в файле «.tmux.conf» в домашней директории пользователя.

Команды которые можно совершать с мультиплексором:

* **Ctrl+b ”** – разделить окно по горизонтали
* **Ctrl+b %** – разделить окно по вертикали
* **Ctrl+b стрелка** – переключиться на панель
* **зажать Ctrl+b и стрелки** – изменить размер панели
* **Ctrl+b c** – открыть новое окно
* **Ctrl+b n** – переключиться на следующее окно
* **Ctrl+b p** -переключиться на предыдущее окно
* **Ctrl+b N** – переключиться на окно номер N
* **Ctrl+b t** – цифровые часы
* **Ctrl+b ?** – список команд
* **Ctrl+b :** - командная строка
* **Ctrl+b q** – отобразить номера панелей
* **Ctrl+b x** – убить панель

**Посмотреть все открытые вкладки и создать дополнительную, в которой открыть часы**

Важно заметить что \* показывает открытую в данный момент вкладку

**Посмотреть список запущенных tmux’ов.**

```
~$ tmux list-session
```

### 5 Команда nohup

**nohup** — утилита, которая позволяет запустить команду, защищенную от зависания с выходом на non-tty (игнорирует потерю сигналов связи SIGHUP).

**скачать очень объемный файл в фоновом режиме**

``` 
~$ nohup wget http://example.com/some-large-package.iso &
```

**убедиться в том, что процесс все еще выполняется**

``` 
~$ ps aux | grep wget
```

Можно использовать nohup, утилита по умолчанию пишет вывод в файл, процесс не прервется при отсоединении от терминала (в случае если пользователь выполнит log out и выйдет из системы)

**узнать версию программы**

``` 
~$ nohup --version
```

Контроля над процессом, тем не менее, нет. Можно только дождаться его завершения или вручную прекратить его выполнение.

**остановить процесс принудительно.**

```
~$ killall wget
```  

### 6 Команда perf

**Perf** анализирует работу системы и приложений, формируя детальные отчеты о нагрузке,   обусловленной различными вызовами, процессами, операциями ввода-вывода, сетевыми событиями и т.п.

#### 6.1 Ключ stat

**собрать стандартную статистику системного события, включая сведения об инструкциях и временных циклах**

```
~# perf stat command
```

у perf stat есть несколько своих подключей, но мы их не использовали. В нашем примере рассматривалась статистика команды date.

#### 6.2 Ключ top
 
**осуществить сбор статистики в реальном времени аналогично top.**

```
~# perf top
```

#### 6.3 Ключ list

**вывести список доступных событий.**

```
~$ perf list
```
#### 6.4 Ключ record

**собрать данные и сохранить их в файл, анализ которого может быть выполнен с помощью perf report**

```
~# perf record –F 99 command
```

Комментарий: у perf record есть несколько ключей и параметров, в которые мы не будем углубляться. В нашем пример «–F» обозначает, функции центрального процессора, а число 99 – количество Герц.

#### 6.5 Ключ report

**сформировать отчет из полученных из файла сведений о производительности**

```
~# perf report
```

Данные, которые эта команда берет для отчета, находятся в файле «perf.data», поэтому, если в него ничего не помещено командой «perf record», то машина выведет ошибку, сообщающую, что «perf.data» пуст.

### 7 Команда chroot

**Chroot**  операция изменения корневого каталога диска для запущенного процесса и его дочерних процессов. Программа, запущенная в таком окружении не может получить доступ к файлам вне нового корневого каталога. Это измененное окружение называется **chroot jail.**

Chroot-окружение Linux не стоит использовать в качестве средства защиты. В целом, окружения chroot могут быть использованы как дополнительный уровень безопасности, но они не достаточно изолированы, чтобы выступать в качестве полноценной защиты системы.

Изменение корневого каталога обычно производится для выполнения действий по обслуживанию систем, загрузка и/или вход в которых стали невозможны. В таком режиме, например, могут быть выполнены:

* Переустановка загрузчика.
* Пересборка образа initramfs.
* Обновление или откат пакетов.
* Сброс пароля root.

**изменить корневой раздел**

```
~# chroot /proc/1/cwd/
```