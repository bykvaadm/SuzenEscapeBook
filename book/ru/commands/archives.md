Tar

Потребность упаковывать и сжимать файлы в виде одного архива возникла примерно в то же самое время, когда компьютеры впервые получили жесткие диски, и эта потребность не исчезла до сегодняшнего дня. Каждый день в виде архивов загружается на сайты и скачивается с сайтов все, начиная от документов и фотографий и заканчивая программами и драйверами устройств. Большинство пользователей знакомы с файлами .zip, однако есть гораздо больше архиваторов, которые не так известны, как .zip. Tar — это стандартная утилита, с помощью которой выполняется архивирование файлов Linux. Постепенно из небольшой программы архивации она превратилась в мощный инструмент, поддерживающий работу со многими вариантами архивов и алгоритмами сжатия. Программа поддерживает большое количество параметров. Первоначально она означала «Tape Archive» («Архив на магнитной ленте»), но это было тогда, когда ленты были основным носителем для переноса данных. Команда tar является очень гибкой и она может создавать, сжимать, обновлять, распаковывать и тестировать архивные файлы. По умолчанию расширением для несжатого архива tar (иногда называемым файлом tar или архивом tarball) является расширение .tar, тогда как для сжатых архивов tar чаще всего используют расширение .tgz (означающее, что архив tar сжат с помощью команды GNU zip). В действительности в архивах tar предлагается несколько различных методов сжатия, в том числе bzip2, zip, LZW и LZMA. Рассмотрим ее синтаксис и основные параметры:
$ tar опции f файл_для_записи /папка_c_файлами_для_архива

Ключи:
    • c — создать новый архив 
    • d — сравнить файлы архива и распакованные файлы в файловой системе
    • r — добавить файлы в конец архива
    • t — показать содержимое архива
    • u — обновить архив относительно файловой системы
    • x — извлечь файлы из архива
    • f — файл для записи архива

Примеры:

    1) Задача: создать архив из указанных файлов
Команда:
tar –czvf archive1.tar.gz  file1 file2

Результат:

    2) Задача: извлечь файлы из архива
Команда: 
tar –xvf archive1 file3 file4

Результат:




    3) Задача: получить список файлов архива
Команда: 
tar –tf archive1.tar.gz

Результат:
 

    4) Задача: сравнение архива с его источником в файловой системе
Команда: 
tar –df archive1.tar.gz

Результат:



    5) Задача: дописать файл в конец архива
Команда:
tar -rf archive3.tar file7

Результат:
 

    6) Задача: обновить существующий архив
Команда: 
tar -uf archive3.tar file8
Результат:



Вывод: команда tar  используется для архивации файлов и поставляется по умолчанию во всех дистрибутивах. В её возможности входит создание и распаковка архива файлов без их сжатия. Для сжатия утилита применяется в связке с популярными компрессорами bzip2 и gzip.





















Gzip
Как создать архив в linux мы рассмотрели. Теперь поговорим о сжатии. Для сжатия используются специальные утилиты. Рассмотрим кратко несколько из них. Gzip – это уже классический инструмент сжатия данных в Linux. Он появился в 1992 году и до сих пор находится в разработке.
Инструмент gzip использует алгоритм сжатия DEFLATE (который также используется другими популярными технологиями, такими как PNG, HTTP, SSH).
Одно из главных преимуществ инструмента gzip – его скорость. Он может сжимать и распаковывать данные с гораздо более высокой скоростью, чем некоторые другие популярные технологии (особенно если сравнить наиболее компактные форматы сжатия каждой утилиты). Он также очень эффективен в плане использования памяти при сжатии и распаковке и не требует больше памяти при оптимизации сжатия. Ещё одним преимуществом gzip является совместимость. Поскольку gzip – очень старый инструмент, почти все системы Linux независимо от возраста  поддерживают gzip.
Его самый большой недостаток заключается в том, что он сжимает данные менее тщательно, чем некоторые другие средства сжатия. Если вы часто сжимаете и распаковываете большое количество данных, gzip вполне подходит; но если необходимо сжать файл один раз и сохранить его, тогда лучше рассмотреть другие варианты.
Ключи:
    • -c — выводить архив в стандартный вывод
    • -d — распаковать
    • -l — показать информацию об архиве
    • -r — рекурсивно перебирать каталоги
    • -0 — минимальный уровень сжатия
    • -9 — максимальный уровень сжатия
Примеры:
        1) Задача: сжатие файла и его распаковка
Команда: 
gzip –c file19 > foo.gz
gunzip –c >foo

Результат:

        2) Задача: показать информацию об архиве
Команда: 
gzip –l archive1.gzip

Результат:




        3) Задача: сжать файл с максимальным уровнем сжатия
Команда:
gzip -9 file29
Результат:










        4) Задача: распаковать файл в стандартный вывод  и посчитать количество строк в распакованном потоке
Команда:
gzip –d –c file_1.gz | wc –l
Результат:


        5) Задача: выполнить рекурсивный переход по структуре каталогов и сжать найденные там файлы
Команда:
gzip –r qwert
Результат: 


Вывод: Одно из главных преимуществ инструмента gzip – его скорость. Он может сжимать и распаковывать данные с гораздо более высокой скоростью, чем некоторые другие популярные технологии. Он также очень эффективен в плане использования памяти при сжатии и распаковке и не требует больше памяти при оптимизации сжатия. Ещё одним преимуществом gzip является совместимость. Поскольку gzip – очень старый инструмент, почти все системы Linux независимо от возраста  поддерживают gzip.






Gunzip.
Есть совершенно другой инструмент, который можно использовать для разжатия или сжатия архивов, созданных Gzip. Это инструмент gunzip.
Gunzip принимает список файлов из командной строки и заменяет каждый файл, имя которого заканчивается .gz, -gz, .z, -z, или _z (игнорируя случай) и который начинается с правильным магическим числом с несжатым файлом без oригинального расширения. Gunzip также распознает специальные расширения .tgz и .taz как сокращения .tar.gz и .tar.Z соответственно. При сжатии, GZIP использует расширение .tgz в случае необходимости вместо усечения  в файл с расширением .tar. 
 Gunzip в настоящее время может распаковывать файлы, созданные с помощью Gzip, Zip, compress, compress -Н или pack. Обнаружение входного формата происходит автоматически. При использовании первых двух форматов, Gunzip проверяет 32 - битный CRC. Для упаковки и разархивирования проверяет несжатую длину. Стандартный формат сжатия не был разработан, чтобы обеспечить проверку соответствия. Однако Gunzip в некоторых случаях способен обнаружить плохой .Z - файл. Если при разжатии файла вы получаете сообщение об ошибке при разархивации файла .Z, то предполагается, что файл .Z не верного стандарта. 
Полный список опций и примеров использования этого инструмента приведен в описании утилиты gzip.





Md5sum.
Контрольная сумма — это цифра или строка, которая вычисляется путем суммирования всех цифр нужных данных. Ее можно использовать в дальнейшем для обнаружения ошибок в проверяемых данных при хранении или передаче. Тогда контрольная сумма пересчитывается еще раз и полученное значение сверяется с предыдущим.
Контрольные суммы Linux с вычисляемые по алгоритму MD5 (Message Digest 5) могут быть использованы для проверки целостности строк или файлов. MD5 сумма — это 128 битная строка, которая состоит из букв и цифр. Суть алгоритма MD5 в том, что для конкретного файла или строки будет генерироваться 128 битный хэш, и он будет одинаковым на всех машинах, если файлы идентичны. Трудно найти два разных файла, которые бы выдали одинаковые хэши.
В Linux для подсчета контрольных сумм по алгоритму md5 используется утилита md5sum. Вы можете применять ее для проверки целостности загруженных из интернета iso образов или других файлов.
Эта утилита позволяет не только подсчитывать контрольные суммы linux, но и проверять соответствие. Она поставляется в качестве стандартной утилиты из набора GNU
Ключи:
    • -t, --text — читать данные файлов в текстовом режиме (по умолчанию). Перед именем файла выводится пробел.
    • -b, --binary — читать данные файлов в двоичном режиме. Перед именем файла выводится символ *.
    • -c, --check — сверять вычисленные значения MD5 со значениями из файла
Примеры:
    1) Задача: прочитать данные файла в двоичном режиме
Команда: 
md5sum –b sums.md5
Результат:
 


    2) Задача: проверить контрольную сумму со значением из файла
Команда:
md5sum –c sums.md5
Результат:

    3) Задача: прочитать данные файла в текстовом режиме
Команда: 
md5sum –t file_2.md5
Результат:


Вывод: проверка целостности файлов Linux — это очень важный аспект использования системы. Контрольная сумма файла Linux используется не только вручную при проверке загруженных файлов, но и во множестве системных программ, например, в менеджере пакетов.


Unzip.
Утилита для распаковки ZIP называется unzip, она не всегда установлена по умолчанию. Но можно очень просто добавить её в свою систему из официальных репозиториев. Для этого в Debian  надо выполнить:
 $ sudo apt install unzip

Но этой утилите не нужны дополнительные оболочки для распаковки архива. Можно сделать всё прямо из консоли. Синтаксис утилиты:
$ unzip опции файл_архива.zip файлы -x исключить -d папка

    • файл архива — это тот файл, с которым нам предстоит работать;
    • файлы — здесь вы можете указать файлы, которые нужно извлечь, разделять имена файлов пробелом;
    • исключить — файлы, которые извлекать не нужно;
    • папка — папка, в которую будет распакован архив.
Теперь рассмотрим опции утилиты, поскольку она позволяет не только распаковывать архивы, но и выполнять с ними определённые действия:
    • -l — вывести список файлов в архиве;
    • -t — протестировать файл архива на ошибки;
    • -u — обновить существующие файлы на диске;
    • -z — вывести комментарий к архиву;
    • -d – извлечь конкретный файл из архива;
    • -v — вывести всю доступную информацию;
    • -P — указать пароль для расшифровки архива;
    • -j — игнорировать структуру архива и распаковать всё в текущую папку.

Примеры:
    1) Задача: вывести всю доступную информацию об архиве
Команда:
unzip –v archive3.zip
Результат:

    2) Задача: вывести список файлов в архиве
Команда:
unzip –l archive3.zip
Результат:
 



    3) Задача: протестировать файлы архива на ошибки
Команда:
unzip –t archive3.zip

Результат: 

    4) Задача: распаковать архив в текущую папку
Команда:
unzip –j archive3.zip
Результат:

    5) Задача: распаковать архив c помощью пароля
Команда:
unzip –P 1234qwer archive3.zip



Результат:


    6) Задача: извлечь конкретный файл из архива
Команда: 
unzip archive4.zip –d file29.gz
Результат:

    7) Задача: вывести комментарий к архиву
Команда: 
unzip –z archive228.zip






    8) Задача: обновить существующие файлы на диске
Команда:
unzip –u ‘*zip’



Вывод: утилита unzip выполняет вывод списка, тестирование или извлечение файлов из архива ZIP. Стандартное поведение (без опций) заключается в извлечении в текущий каталог (и подкаталоги) всех файлов из указанного архива ZIP.